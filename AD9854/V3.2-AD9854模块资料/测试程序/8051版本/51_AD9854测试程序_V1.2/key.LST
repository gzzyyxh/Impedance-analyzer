C51 COMPILER V9.06   KEY                                                                   06/06/2017 10:23:38 PAGE 1   


C51 COMPILER V9.06, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN key.OBJ
COMPILER INVOKED BY: D:\keil_32\C51\BIN\C51.EXE key.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          //-----------------------------------------------------------------
   2          // 程序描述:
   3          // 　　独立键盘驱动程序
   4          // 作　　者: 凌智电子
   5          // 开始日期: 2014-02-1
   6          // 完成日期: 2014-02-2
   7          // 修改日期: 2014-02-2
   8          // 当前版本: V1.0
   9          // 历史版本:
  10          // 　- V1.0: 独立键盘扫描,键值返回
  11          // 调试工具: 51开发板、1602液晶屏
  12          // 说　　明: 
  13          //        
  14          //-----------------------------------------------------------------
  15          
  16          //-----------------------------------------------------------------
  17          // 头文件包含
  18          //-----------------------------------------------------------------
  19          #include <key.h>
  20          #include <init.h>
  21          
  22          
  23          //-----------------------------------------------------------------
  24          // uchar Key_Scan(void)
  25          //-----------------------------------------------------------------
  26          //
  27          // 函数功能: 独立键盘扫描
  28          // 入口参数: 无
  29          // 返回参数: rst：键值
  30          // 全局变量: 无
  31          // 调用模块: 无    
  32          // 注意事项: 无
  33          //-----------------------------------------------------------------
  34          
  35          uchar Key_Scan(void)
  36          {
  37   1        uchar rst = 0;
  38   1        
  39   1        // 按键隐藏优先级为KEY1>KEY2>KEY3>KEY4
  40   1        if((KEY1==0) || (KEY2==0) || (KEY3==0) || (KEY4==0))
  41   1        {
  42   2          DelayMs(10);      // 延时10ms去抖动
  43   2          if(KEY1 == 0)       // KEY1按下
  44   2          {
  45   3            rst = 1;
  46   3            while(KEY1 == 0); // 松手检测
  47   3          }
  48   2          if(KEY2 == 0)
  49   2          {
  50   3            rst = 2;
  51   3            while(KEY2 == 0);
  52   3          }
  53   2          if(KEY3 == 0)
  54   2          {
  55   3            rst = 3;
C51 COMPILER V9.06   KEY                                                                   06/06/2017 10:23:38 PAGE 2   

  56   3            while(KEY3 == 0);
  57   3          }
  58   2          if(KEY4 == 0)
  59   2          {
  60   3            rst = 4;
  61   3            while(KEY4 == 0);
  62   3          }
  63   2        }
  64   1        else
  65   1          rst = 0;
  66   1        return rst;
  67   1      }
  68          //-----------------------------------------------------------------
  69          // End Of File
  70          //-----------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     64    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
