C51 COMPILER V9.05   DELAY                                                                 07/16/2018 20:28:44 PAGE 1   


C51 COMPILER V9.05, COMPILATION OF MODULE DELAY
OBJECT MODULE PLACED IN .\delay.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\Application\delay.c LARGE BROWSE INCDIR(..\Application;..\Drive) DEBUG O
                    -BJECTEXTEND PRINT(.\delay.lst) TABS(2) OBJECT(.\delay.obj)

line level    source

   1          //-----------------------------------------------------------------------------
   2          // 程序描述:
   3          //     调试不同时基的延时程序:ns,10us,250us,1ms,5ms,50ms
   4          // 作    者: 薛小铃
   5          // 开始日期: 2009-11-21
   6          // 完成日期: 2009-11-21
   7          // 修改日期:
   8          // 版    本: V2.0:修改V1.0的格式和说明方式
   9          // 调试工具: C8051F02xTBC
  10          // 说    明: 
  11          //     (1)调试使用的系统时钟频率Fsysclk=22.1184MHz;
  12          //-----------------------------------------------------------------------------
  13          
  14          //-----------------------------------------------------------------------------
  15          // 头文件包含
  16          //-----------------------------------------------------------------------------
  17          //#include <c8051f020.h>
  18          #include <intrins.h>
  19          #include "delay.h"
  20          
  21          
  22          //-----------------------------------------------------------------------------
  23          // 功能函数区
  24          //-----------------------------------------------------------------------------
  25          
  26          //-----------------------------------------------------------------------------
  27          // void Delay_ns (unsigned char t)
  28          //-----------------------------------------------------------------------------
  29          //
  30          // 函数功能: 时基为ns的延时
  31          // 例子提示: 
  32          // 入口参数: 无符号8bit整数
  33          // 返回参数: 无
  34          // 全局变量: 无
  35          // 调用模块: 无
  36          // 注意事项: 基于使用外22.1184MHz晶振的C8051F020单片机
  37          /*
  38            2008.01.11修改
  39            mov lcall djnz     last_djnz ret
  40            2T +4T   +3T*(t-1)+2T       +5T  =(3t+10)T
  41                          单位： 1SYSCLK  SYSCLK=11.0592MHz   
  42          delay_ns(1):  延时        13            1 175ns
  43          delay_ns(2):  延时        16            1 447ns
  44          delay_ns(3):  延时        19            1 718ns
  45          delay_ns(4):  延时        22            1 989ns     
  46          delay_ns(5):  延时        25            2 261ns
  47          delay_ns(6):  延时        28            2 532ns 
  48          delay_ns(7):  延时        31            2 803ns
  49          delay_ns(8):  延时        34            3 074ns
  50          delay_ns(9):  延时        37            3 346ns
  51          delay_ns(10): 延时        40            3 617ns     
  52          delay_ns(20): 延时        70            6 330ns
  53          delay_ns(50): 延时       160           11 447ns 
  54          */
C51 COMPILER V9.05   DELAY                                                                 07/16/2018 20:28:44 PAGE 2   

  55          //-----------------------------------------------------------------------------
  56          void Delay_ns (unsigned char t)
  57          {
  58   1        do {
  59   2          _nop_();            
  60   2        } while (--t); 
  61   1      }
  62          
  63          //-----------------------------------------------------------------------------
  64          // void Delay_1us (unsigned char t)
  65          //-----------------------------------------------------------------------------
  66          // 函数功能: 时基为10us的延时
  67          // 例子提示: 调用Delay_10us(20),得到200us延时
  68          // 入口参数: 无符号8bit整数
  69          // 返回参数: 无
  70          // 全局变量: 无
  71          // 调用模块: 无
  72          // 注意事项: 基于使用外22.1184MHz晶振的C8051F020单片机
  73          //-----------------------------------------------------------------------------
  74          //void Delay_1us (unsigned char t)
  75          //{
  76          //  do {
  77          //    _nop_();          //4ge
  78          //    _nop_();
  79          //    _nop_();
  80          //    _nop_();
  81          //  } while ( -- t);  
  82          //
  83          //}
  84          
  85          //-----------------------------------------------------------------------------
  86          // void Delay_10us (unsigned char t)
  87          //-----------------------------------------------------------------------------
  88          //
  89          // 函数功能: 时基为10us的延时
  90          // 例子提示: 调用Delay_10us(20),得到200us延时
  91          // 入口参数: 无符号8bit整数
  92          // 返回参数: 无
  93          // 全局变量: 无
  94          // 调用模块: 无
  95          // 注意事项: 基于使用外22.1184MHz晶振的C8051F020单片机
  96          /* 
  97          2008.06.14编写
  98          延时公式：令x=9,y=1,n=8 注：x=10效果可能会更好些
  99            {[4y+(n+3)xy+4]*t+10}T=(107t+10)T  (118t+10)T
 100          */
 101          //-----------------------------------------------------------------------------
 102          void Delay_10us (unsigned char t)
 103          {
 104   1        unsigned char i,j;
 105   1         
 106   1        do {
 107   2          j = 1;  
 108   2          do {
 109   3            i = 9;//251;
 110   3            do {                    // 9ge
 111   4               _nop_();_nop_();_nop_();_nop_();
 112   4               _nop_();_nop_();_nop_();_nop_();
 113   4               _nop_();_nop_();//                 
 114   4               _nop_();_nop_();_nop_();_nop_();
 115   4               _nop_();_nop_();_nop_();_nop_();
 116   4               _nop_();_nop_();//                 
C51 COMPILER V9.05   DELAY                                                                 07/16/2018 20:28:44 PAGE 3   

 117   4               } while (--i); 
 118   3          } while (--j);    
 119   2        } while (--t); 
 120   1      } 
 121          
 122          //-----------------------------------------------------------------------------
 123          // void Delay_250us (unsigned char t)
 124          //-----------------------------------------------------------------------------
 125          //
 126          // 函数功能: 时基为250us的延时
 127          // 例子提示: 调用Delay_250us(20),得到5ms延时
 128          // 入口参数: 无符号8bit整数
 129          // 返回参数: 无
 130          // 全局变量: 无
 131          // 调用模块: 无
 132          // 注意事项: 基于使用外22.1184MHz晶振的C8051F020单片机
 133          /* 
 134          2008.06.14编写
 135          延时公式：令x=250,y=1,n=8
 136            {[4y+(n+3)xy+4]*t+10}T=(2769t+10)T
 137          */
 138          //-----------------------------------------------------------------------------
 139          //void Delay_250us (unsigned char t)
 140          //{
 141          //  unsigned char i,j;
 142          //   
 143          //  do {
 144          //    j = 1;  
 145          //    do {
 146          //      i = 250;//251;
 147          //      do {                    // 9ge
 148          //         _nop_();_nop_();_nop_();_nop_();
 149          //         _nop_();_nop_();_nop_();_nop_();
 150          //         _nop_();_nop_();//                 
 151          ////         _nop_();_nop_();_nop_();_nop_();
 152          ////         _nop_();_nop_();_nop_();_nop_();
 153          ////         _nop_();_nop_();//                 
 154          //         } while (--i); 
 155          //    } while (--j);    
 156          //  } while (--t); 
 157          //}
 158          
 159          //-----------------------------------------------------------------------------
 160          // void Delay_882us (void)
 161          //-----------------------------------------------------------------------------
 162          //
 163          // 函数功能: 延时882us
 164          // 入口参数: 无
 165          // 返回参数: 无
 166          // 全局变量: 无
 167          // 调用模块: 无     
 168          // 注意事项: 延时时间为876us,误差为6us
 169          //-----------------------------------------------------------------------------
 170          //void Delay_882us (void)             
 171          //{ 
 172          //  unsigned char i,j;   
 173          //  j = 85;
 174          //  
 175          //  do {
 176          //    i = 10;
 177          //    do {                    // 9ge
 178          //      _nop_();_nop_();_nop_();_nop_();
C51 COMPILER V9.05   DELAY                                                                 07/16/2018 20:28:44 PAGE 4   

 179          //      _nop_();_nop_();_nop_();_nop_();
 180          //      _nop_();_nop_();//                  
 181          ////      _nop_();_nop_();_nop_();_nop_();
 182          ////      _nop_();_nop_();_nop_();_nop_();
 183          ////      _nop_();_nop_();//                  
 184          //    } while (--i);  
 185          //  } while (--j);      
 186          //}
 187          
 188          //-----------------------------------------------------------------------------
 189          // void Delay_1ms (unsigned char t)
 190          //-----------------------------------------------------------------------------
 191          //
 192          // 函数功能: 时基为1ms的延时
 193          // 例子提示: 调用Delay_1ms(20),得到20ms延时
 194          // 入口参数: 无符号8bit整数
 195          // 返回参数: 无
 196          // 全局变量: 无
 197          // 调用模块: 无
 198          // 注意事项: 基于使用外22.1184MHz晶振的C8051F020单片机
 199          /* 
 200          2008.01.11编写
 201          令x=251,y=4,n=8,则延时时间
 202                   ={[4y+(n+3)xy+4]*t+10}T=(11064t+10)T
 203                          单位:    1SYSCLK  SYSCLK=11.0592MHz   误差
 204          delay_5ms(1): 延时      11 074      1.001ms          1us
 205          delay_5ms(1): 延时      22 138      2.002ms          2us
 206          delay_5ms(5): 延时      55 330      5.002ms          2us
 207          delay_5ms(10):  延时     110 650     10.005ms          5us
 208          delay_5ms(20):  延时     221 290     20.010ms         10us
 209          delay_5ms(40):  延时     442 570     40.018ms         18us
 210          delay_5ms(60):  延时     663 850     60.030ms         30us
 211          delay_5ms(100):延时   1 106 410    100.044ms         44us
 212          */
 213          //-----------------------------------------------------------------------------
 214          //void Delay_1ms (unsigned char t)
 215          //{
 216          //  unsigned char i,j;
 217          //   
 218          //  do {
 219          //    j = 4;  
 220          //    do {
 221          //      i = 251;
 222          //      do {                    // 9ge
 223          //         _nop_();_nop_();_nop_();_nop_();
 224          //         _nop_();_nop_();_nop_();_nop_();
 225          //         _nop_();_nop_();//                 
 226          ////         _nop_();_nop_();_nop_();_nop_();
 227          ////         _nop_();_nop_();_nop_();_nop_();
 228          ////         _nop_();_nop_();//                 
 229          //         } while (--i);
 230          //    } while (--j);    
 231          //  } while (--t); 
 232          //}
 233          
 234          //-----------------------------------------------------------------------------
 235          // void Delay_5ms (unsigned char t)
 236          //-----------------------------------------------------------------------------
 237          //
 238          // 函数功能: 时基为5ms的延时
 239          // 例子提示: 调用Delay_5ms(20),得到100ms延时
 240          // 入口参数: 无符号8bit整数
C51 COMPILER V9.05   DELAY                                                                 07/16/2018 20:28:44 PAGE 5   

 241          // 返回参数: 无
 242          // 全局变量: 无
 243          // 调用模块: 无
 244          // 注意事项: 基于使用外22.1184MHz晶振的C8051F020单片机
 245          /* 
 246          令x=251,y=20,n=8,则延时时间
 247                   ={[4y+(n+3)xy+4]*t+10}T=(55304t+10)T
 248                          单位:    1SYSCLK  SYSCLK=11.0592MHz   误差
 249          delay_5ms(1): 延时      55 314      5.002ms          2us
 250          delay_5ms(2): 延时     110 618     10.002ms          2us
 251          delay_5ms(5): 延时     276 530     25.005ms          5us
 252          delay_5ms(10):  延时     553 050     50.008ms          8us
 253          delay_5ms(20):  延时   1 106 090    100.015ms         15us
 254          delay_5ms(40):  延时   2 212 170    200.030ms         30us
 255          delay_5ms(60):  延时   3 318 250    300.044ms         44us
 256          delay_5ms(100):延时   5 530 410    500.073ms         73us
 257          */
 258          //-----------------------------------------------------------------------------
 259          //void Delay_5ms (unsigned char t)
 260          //{
 261          //  unsigned char i,j;
 262          //   
 263          //  do {
 264          //    j = 20; 
 265          //    do {
 266          //      i = 251;
 267          //      do {                    // 9ge
 268          //         _nop_();_nop_();_nop_();_nop_();
 269          //         _nop_();_nop_();_nop_();_nop_();
 270          //         _nop_();_nop_();//                 
 271          ////         _nop_();_nop_();_nop_();_nop_();
 272          ////         _nop_();_nop_();_nop_();_nop_();
 273          ////         _nop_();_nop_();//                 
 274          //         } while (--i);
 275          //    } while (--j);    
 276          //  } while (--t); 
 277          //}
 278          
 279          //-----------------------------------------------------------------------------
 280          // void Delay_50ms (unsigned char t)
 281          //-----------------------------------------------------------------------------
 282          //
 283          // 函数功能: 时基为50ms的延时
 284          // 例子提示: 调用Delay_50ms(20),得到1s延时
 285          // 入口参数: 无符号8bit整数
 286          // 返回参数: 无
 287          // 全局变量: 无
 288          // 调用模块: 无
 289          // 注意事项: 基于使用外22.1184MHz晶振的C8051F020单片机
 290          /* 
 291          令x=251,y=200,n=8,则延时时间
 292                   ={[4y+(n+3)xy+4]*t+10}T=(553004t+10)T
 293                          单位:    1SYSCLK  SYSCLK=11.0592MHz   误差
 294          delay_50ms(1):  延时     553 014     50.005ms          5us
 295          delay_50ms(2):  延时   1 106 018    100.009ms          9us
 296          delay_50ms(5):  延时   2 765 030    250.021ms         21us
 297          delay_50ms(10):延时   5 530 050    500.041ms         41us
 298          delay_50ms(20):延时  11 060 090   1000.080ms         80us
 299          delay_50ms(40):延时  22 120 170   2000.160ms        160us
 300          delay_50ms(60):延时  33 180 250   3000.240ms        240us
 301          delay_50ms(100):延时 55 300 410   5000.399ms        399us
 302          */
C51 COMPILER V9.05   DELAY                                                                 07/16/2018 20:28:44 PAGE 6   

 303          //-----------------------------------------------------------------------------
 304          //void Delay_50ms (unsigned char t)
 305          //{
 306          //  unsigned char i,j;
 307          //   
 308          //  do {
 309          //    j = 201;  
 310          //    do {
 311          //      i = 250;
 312          //      do {                    // 9ge
 313          //         _nop_();_nop_();_nop_();_nop_();
 314          //         _nop_();_nop_();_nop_();_nop_();
 315          //         _nop_();_nop_();//                 
 316          ////         _nop_();_nop_();_nop_();_nop_();
 317          ////         _nop_();_nop_();_nop_();_nop_();
 318          ////         _nop_();_nop_();//                 
 319          //         } while (--i);
 320          //    } while (--j);    
 321          //  } while (--t); 
 322          //}
 323          
 324          
 325          //-----------------------------------------------------------------------------
 326          // End Of File
 327          //-----------------------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     35    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
